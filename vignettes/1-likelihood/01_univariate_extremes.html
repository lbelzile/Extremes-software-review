<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Likelihood inference for univariate extremes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="01_univariate_extremes_files/libs/clipboard/clipboard.min.js"></script>
<script src="01_univariate_extremes_files/libs/quarto-html/quarto.js"></script>
<script src="01_univariate_extremes_files/libs/quarto-html/popper.min.js"></script>
<script src="01_univariate_extremes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01_univariate_extremes_files/libs/quarto-html/anchor.min.js"></script>
<link href="01_univariate_extremes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01_univariate_extremes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01_univariate_extremes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01_univariate_extremes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01_univariate_extremes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="01_univariate_extremes_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="01_univariate_extremes_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#density-and-distribution-function-checks" id="toc-density-and-distribution-function-checks" class="nav-link active" data-scroll-target="#density-and-distribution-function-checks">Density and distribution function checks</a></li>
  <li><a href="#optimization-routines" id="toc-optimization-routines" class="nav-link" data-scroll-target="#optimization-routines">Optimization routines</a>
  <ul class="collapse">
  <li><a href="#generalized-pareto-distribution" id="toc-generalized-pareto-distribution" class="nav-link" data-scroll-target="#generalized-pareto-distribution">Generalized Pareto distribution</a></li>
  <li><a href="#generalized-extreme-value-distribution" id="toc-generalized-extreme-value-distribution" class="nav-link" data-scroll-target="#generalized-extreme-value-distribution">Generalized extreme value distribution</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Likelihood inference for univariate extremes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="density-and-distribution-function-checks" class="level2">
<h2 class="anchored" data-anchor-id="density-and-distribution-function-checks">Density and distribution function checks</h2>
<p>We performed some sanity checks for various maximum likelihood estimation routine and parametric model implementations. Specifically, we verified that density functions are non-negative and evaluate to zero outside of the domain of the distribution, and that distribution functions are non-decreasing and map to the unit interval.</p>
<p>The generalized Pareto distribution has lower bound at the location parameter <span class="math inline">\(u\)</span> and is bounded above at <span class="math inline">\(u -\sigma/\xi\)</span> whenever <span class="math inline">\(\xi &lt; 0\)</span>. Many software implementations forgo the location parameter, since for modelling large quantiles of a random variable <span class="math inline">\(Y\)</span> above threshold <span class="math inline">\(u\)</span>, it suffices to look at threshold exceedances <span class="math inline">\(Y-u &gt;0\)</span>. No threshold exceedance should be exactly equal to zero so the value of the density at that point is immaterial, even if it should be set to zero in practice.</p>
<div class="cell" data-hash="01_univariate_extremes_cache/html/tbl-gp1_ac497bc76af255bc47f343a04d8605a5">
<div class="cell-output-display">
<div id="tbl-gp1" class="anchored">

<table class="table" style="margin-left: auto; margin-right: auto;"><caption>Table&nbsp;1:  Evaluation of generalized Pareto model density and distribution functions. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> package </th>
   <th style="text-align:left;"> location </th>
   <th style="text-align:left;"> density </th>
   <th style="text-align:left;"> distribution function </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> eva </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> evd </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> evir </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x &lt; loc </td>
   <td style="text-align:left;"> incorrect outside support </td>
  </tr>
  <tr>
   <td style="text-align:left;"> extraDistr </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> extRemes </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fExtremes </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lmom </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> incorrect outside support </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lmomco </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> incorrect outside support </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mev </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> POT </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> QRM </td>
   <td style="text-align:left;"> no </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> qrmtools </td>
   <td style="text-align:left;"> no </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ReIns </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Renext </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> revdbayes </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> SpatialExtremes </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> incorrect for x = loc </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tea </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> texmex </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TLMoments </td>
   <td style="text-align:left;"> yes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-hash="01_univariate_extremes_cache/html/tbl-gev1_ef79d3380f107b41b0d7dd36ee6534a0">
<div class="cell-output-display">
<div id="tbl-gev1" class="anchored">

<table class="table" style="margin-left: auto; margin-right: auto;"><caption>Table&nbsp;2:  Evaluation of generalized extreme value density and distribution functions. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> package </th>
   <th style="text-align:left;"> density </th>
   <th style="text-align:left;"> distribution function </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> EnvStats </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> evd </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> evir </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> extraDistr </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ExtremalDep </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> extRemes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fExtremes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lmomco </td>
   <td style="text-align:left;"> incorrect for x &lt; loc </td>
   <td style="text-align:left;"> incorrect for x &lt; loc </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mev </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> QRM </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> qrmtools </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> revdbayes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> SpatialExtremes </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> texmex </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TLMoments </td>
   <td style="text-align:left;"> correct </td>
   <td style="text-align:left;"> correct </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Certain packages, listed in <a href="#tbl-gp1">Table&nbsp;1</a> and <a href="#tbl-gev1">Table&nbsp;2</a>, have incorrect implementations of density and distribution functions.</p>
</section>
<section id="optimization-routines" class="level2">
<h2 class="anchored" data-anchor-id="optimization-routines">Optimization routines</h2>
<p>We compared the maximum likelihood estimates returned by default estimation procedures for different packages for simulated data, checking that the value returned is a global optimum and the gradient is approximately zero whenever <span class="math inline">\(\widehat{\xi} &gt; -1\)</span>. For the generalized extreme value distribution, both <code>POT</code> and <code>evd</code> return sampling distributions that are underdispersed relative to other implementations, while <code>ercv</code> and <code>extRemes</code> both have a large number of runs that return exactly zero for the shape parameter.</p>
<section id="generalized-pareto-distribution" class="level3">
<h3 class="anchored" data-anchor-id="generalized-pareto-distribution">Generalized Pareto distribution</h3>
<p>For threshold exceedances, we simulated <!-- $n=200, \ldots, 900$ observations and set the threshold to the theoretical quantile of the distribution. We focus in the report on $n=400$, which leads to an average of 20 exceedances. 
--> 50 exceedances from a generalized Pareto distribution <span class="math inline">\(\mathsf{GP}(\sigma=1000, \xi=-0.5)\)</span> and from an exponential distribution with <span class="math inline">\(\sigma=1000\)</span>. The large scale value is intended to check the robustness of gradient-based algorithms; from an optimization perspective, it is wise to ensure that the gradient of each component, scale and shape, are not magnitude apart. The data can easily be scaled prior to the optimization in case this is problematic.</p>
<div class="cell" data-hash="01_univariate_extremes_cache/html/fig-gpfit-comput_081bf8b6070255dfb4b03d8f08757c6c">

</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gpfit-grad" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="01_univariate_extremes_files/figure-html/fig-gpfit-grad-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Magnitude of the shape component of the score vector at the value returned by the optimization routine. The density plots are based on 1000 samples simulated from a generalized Pareto distribution with shape <span class="math inline">\(\xi =-0.5\)</span> and scale <span class="math inline">\(\sigma=1000\)</span>, split by simulations yielding a boundary case (<span class="math inline">\(\widehat{\xi} = -1\)</span>, gray) and regular case (<span class="math inline">\(\widehat{\xi} &gt; -1\)</span>, black); the <span class="math inline">\(y\)</span>-axis scale for each package is different to ease visualization. Results for samples for which the numerical routines failed to converge or the gradient is unevaluated are not shown.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gpfit-grad">Figure&nbsp;1</a> shows the distribution of the score vector, i.e., the gradient of the log likelihood. The latter should vanish when evaluated at the maximum likelihood estimator (<span class="math inline">\(\widehat{\sigma}, \widehat{\xi}\)</span>) provided <span class="math inline">\(\widehat{\xi} &gt; -1\)</span>. Most instances of non-zero gradient are attributable to boundary cases with <span class="math inline">\(\widehat{\xi}=-1\)</span> not accounted for. Other discrepancies are due to numerical tolerance for convergence, but the differences in log likelihood relative to the maximum over all routines are negligible in most non-boundary cases investigated. Some routines, based on Nelder–Mead simplex algorithm, do not check the gradient but this is immaterial if the value of the function is nearly identical to that of the maximum likelihood.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gpfit-diffmle" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="01_univariate_extremes_files/figure-html/fig-gpfit-diffmle-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Difference between likelihood evaluated at parameters returned by routine and the maximum likelihood over all routines for generalized Pareto samples with negative shape (left) and exponential samples (right), both with large scale parameter <span class="math inline">\(\sigma=1000\)</span>. Results for samples for which the numerical routines failed to converge are not shown. Only packages with 90% percentile giving a discrepancy larger than <span class="math inline">\(10^{-4}\)</span> are shown.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gpfit-diffmle">Figure&nbsp;2</a> shows these differences through survival function plots, highlighting instances where the package fails to return correct values. Most packages do fine, except for a handful: <code>evd</code>, <code>extRemes</code> and <code>POT</code> (which uses routines from <code>evd</code>) stand out of the lot.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gpfit-shapepar" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="01_univariate_extremes_files/figure-html/fig-gpfit-shapepar-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Dot plots of shape parameters returned by optimization routine for generalized Pareto samples with negative shape (left) and exponential samples (right). Results for samples for which the numerical routines failed to converge are not shown.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can figure out the source of some of these oddities by plotting the distribution of the shape parameter over all 1000 replications. <a href="#fig-gpfit-shapepar">Figure&nbsp;3</a>: the <code>QRM</code> package has unexpected small spread and a positive bias for estimation <span class="math inline">\(\xi\)</span>, different from other packages because it fails more often when <span class="math inline">\(\xi\)</span> is negative. Both <code>ercv</code> and <code>extRemes</code> routines return zero shape estimates, leading to noticeable point masses. <code>Renext</code> returns a hard-coded lower bound, while only <code>SpatialExtremes</code> and <code>mev</code> correctly return <span class="math inline">\(\xi=-1\)</span>.</p>
<div class="cell" data-tab-cap="Number of failures (out of 1000 simulations) per package for bounded ($\xi=-0.5$), light-tailed ($\xi=0$) and heavy-tailed ($\xi=0.5$) samples from a generalized Pareto distribution.">

</div>
<p>Some package have routines that fail to converge often when the shape is negative; the most likely culprit for this is poor starting values. The routines in <code>ercv</code> and <code>fExtremes</code> (same as <code>evir</code>) fail often in small samples: for <span class="math inline">\(n=20\)</span> exceedances, the function returned an error in 225 simulations. For the latter, the error is due to poor implementation of the log-likelihood that leads to infinite finite differences between estimates. For <code>QRM</code>, the choice of starting values, which cannot be modified by the user, is not adequate with strong negative shapes: it failed more than 50 (<span class="math inline">\(n=20\)</span>), 122 (<span class="math inline">\(n=50\)</span>), 169 (<span class="math inline">\(n=100\)</span>) and 253 (<span class="math inline">\(n=1000\)</span>) times for negative shapes, indicating that the issue is not sample size. The <code>qrmtools</code> package, which supersedes <code>QRM</code>, has no such problems.</p>
</section>
<section id="generalized-extreme-value-distribution" class="level3">
<h3 class="anchored" data-anchor-id="generalized-extreme-value-distribution">Generalized extreme value distribution</h3>
<p>The optimization routines for the generalized extreme value distribution are better behaved and nearly all packages give identical results: only <code>evd</code> and <code>texmex</code> failed to converge and returned abnormally high shape values in a handful of instances out of 1000 simulations.</p>
<div class="cell" data-hash="01_univariate_extremes_cache/html/gevfit-computation_f379bf0ed9244992f681d99f8a5d7d79">

</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gevfit-diffmle" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="01_univariate_extremes_files/figure-html/fig-gevfit-diffmle-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Difference between likelihood evaluated at parameters returned by routine and the maximum likelihood over all routines for generalized extreme value samples with negative shape (left) and exponential samples (right), both with large scale parameter <span class="math inline">\(\sigma=1000\)</span>. Results for samples for which the numerical routines failed to converge are not shown. Only packages with 90% percentile giving a discrepancy larger than <span class="math inline">\(10^{-4}\)</span> are shown.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Unsurprisingly, the portrait is the same for the generalized extreme value distribution when it comes to boundary constraints: for example, <code>climextRemes</code> does not return shapes less than or equal to <span class="math inline">\(-1\)</span>. <code>extRemes</code> has odd behaviour with a visible point mass at <span class="math inline">\(\xi=0\)</span> in the simulations, even when this value has measure zero. Only <code>mev</code> and <code>SpatialExtremes</code> handle the boundary constraints. <a href="#fig-gevfit-diffmle">Figure&nbsp;4</a> shows the difference in maximum likelihood returned by the packages, excluding cases with <span class="math inline">\(\widehat{\xi}=-1\)</span> for which the log likelihood becomes unbounded for combinations of <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\xi&lt;-1\)</span>. Some packages, such as <code>evd</code>, also sometimes return local optimum (perhaps due to use of the BFGS routine) and this in turn leads to erroneous comparisons of nested models.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gevfit-shapepar" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="01_univariate_extremes_files/figure-html/fig-gevfit-shapepar-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Dot plots of shape parameters returned by optimization routine for generalized extreme value samples with negative shape (left) and Gumbel samples (right). Results for samples for which the numerical routines failed to converge are not shown.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div id="tbl-gevnonconv" class="cell tbl-parent quarto-layout-panel anchored" data-hash="01_univariate_extremes_cache/html/tbl-gevnonconv_4cb8a84da0eaaa1aa195b2d6aa5666c0">
<div class="panel-caption table-caption">
<p>Table&nbsp;3: Number of failures for the optimization routine for maximum likelihood-based estimation of the generalized extreme value model (out of 1000 simulations).</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-gevnonconv-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-gevnonconv" style="flex-basis: 100.0%;justify-content: center;">

<table class="table" style="margin-left: auto; margin-right: auto;"><caption>(a) bounded tail </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> n </th>
   <th style="text-align:right;"> climextRemes </th>
   <th style="text-align:right;"> evir </th>
   <th style="text-align:right;"> fExtremes </th>
   <th style="text-align:right;"> ismev </th>
   <th style="text-align:right;"> texmex </th>
   <th style="text-align:right;"> mev </th>
   <th style="text-align:right;"> EnvStats </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 172 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 92 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 100 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:right;"> 127 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 131 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 100 </td>
   <td style="text-align:right;"> 151 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 156 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1000 </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 215 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-gevnonconv-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-gevnonconv" style="flex-basis: 100.0%;justify-content: center;">

<table class="table" style="margin-left: auto; margin-right: auto;"><caption>(b) light tail </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> n </th>
   <th style="text-align:right;"> climextRemes </th>
   <th style="text-align:right;"> fExtremes </th>
   <th style="text-align:right;"> EnvStats </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 100 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-gevnonconv-3" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-gevnonconv" style="flex-basis: 100.0%;justify-content: center;">

<table class="table" style="margin-left: auto; margin-right: auto;"><caption>(c) heavy tail </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> n </th>
   <th style="text-align:right;"> climextRemes </th>
   <th style="text-align:right;"> evir </th>
   <th style="text-align:right;"> fExtremes </th>
   <th style="text-align:right;"> EnvStats </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 100 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p><a href="#tbl-gevnonconv">Table&nbsp;3</a> gives a breakdown of the number of instances for which the maximisation routine failed: two packages, <code>climextRemes</code> and <code>EnvStats</code>, stand out for negative shapes and the percentage of failures increases with the sample size.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>